<style>
    #s-plugin-payrem-sendtest {
        padding: 7px 20px;
        margin: 10px;
        background: #F8F8FF;
        border: 1px dashed #D3D3D3;
        border-radius: 3px;
        -moz-border-radius: 3px;
        -webkit-border-radius: 3px;
        -moz-box-shadow: 0 0 0 4px #F8F8FF;
        -webkit-box-shadow: 0 0 0 4px #F8F8FF;
        box-shadow: 0 0 0 4px #F8F8FF;
        text-shadow: 1px 1px 2px #F8F8FF;
        font-weight: normal;
    }

    #s-plugin-payrem-sendtest label {
        display: block;
        margin-top: 10px;
        font-weight: bold;
    }

    #s-plugin-payrem-sendtest button.green {
        border: 1px solid #34740e;
        -webkit-border-radius: 3px;
        -moz-border-radius: 3px;
        border-radius: 3px;
        font-size: 14px;
        font-family: "Lucide Grande", Arial, sans-serif;
        padding: 6px 6px 6px 6px;
        text-decoration: none;
        display: inline-block;
        text-shadow: -1px -1px 0 rgba(0, 0, 0, 0.3);
        font-weight: bold;
        color: #FFFFFF;
        background-color: #4ba614;
        background-image: -webkit-gradient(linear, left top, left bottom, from(#4ba614), to(#008c00));
        background-image: -webkit-linear-gradient(top, #4ba614, #008c00);
        background-image: -moz-linear-gradient(top, #4ba614, #008c00);
        background-image: -ms-linear-gradient(top, #4ba614, #008c00);
        background-image: -o-linear-gradient(top, #4ba614, #008c00);
        background-image: linear-gradient(to bottom, #4ba614, #008c00);
        filter: progid:DXImageTransform.Microsoft.gradient(GradientType=0, startColorstr=#4ba614, endColorstr=#008c00);
    }

    #s-plugin-payrem-sendtest button.green:hover {
        border: 1px solid #224b09;
        background-color: #36780f;
        background-image: -webkit-gradient(linear, left top, left bottom, from(#36780f), to(#005900));
        background-image: -webkit-linear-gradient(top, #36780f, #005900);
        background-image: -moz-linear-gradient(top, #36780f, #005900);
        background-image: -ms-linear-gradient(top, #36780f, #005900);
        background-image: -o-linear-gradient(top, #36780f, #005900);
        background-image: linear-gradient(to bottom, #36780f, #005900);
        filter: progid:DXImageTransform.Microsoft.gradient(GradientType=0, startColorstr=#36780f, endColorstr=#005900);
    }

    #s-plugin-payrem-sendtest-helptext {
        margin-bottom: 15px;
        border-bottom: 1px solid #808080;
        padding: 0 0 5px;
        color: darkgray;
        font-size: 85%;
        line-height: 120%;
    }
</style>
<h1>[`Payment Reminder Plugin Setup`]</h1>
<div class="fields form">
    <form action="?module=plugins&id=payrem&action=save" method="post" id="plugins-settings-form"
          enctype="multipart/form-data" target="plugins-settings-iframe">
        {$wa->csrf()}
        {foreach $settings_controls as $name => $control}
            <div class="field">
                {$control}
            </div>
        {/foreach}

        <div class="field">
            <div class="value submit">
                <input type="submit" class="button green" value="[`Save`]">
                <span id="plugins-settings-form-status" style="display:none"><!-- message placeholder --></span>
            </div>
        </div>

    </form>
    <iframe style="display:none" name="plugins-settings-iframe" id="plugins-settings-iframe"></iframe>
    <div class="field" style="margin: 15px 0" id="s-plugin-payrem-sendtest">
        <div class="name">Протестировать отправку</div>
        <div class="value">
            <div id="s-plugin-payrem-sendtest-helptext">
                Сохраните настройки и отправьте тестовое сообщение. Сообщение будет отправлено на указанный
                e-mail адрес, независимо от того, какой указан в заказе. Статус заказа также не важен.
            </div>
            <div>
                <div>
                    <label for="s-plugin-payrem-sendtest-order-select">
                        Номер заказа
                    </label>
                    <select name="sendtest[order]" id="s-plugin-payrem-sendtest-order-select">
                        {foreach $testsend_orders as $order}
                            <option value="{$order.id}"{if $order@first} selected{/if}>{$order.id_str}</option>
                        {/foreach}
                    </select>
                </div>
                <div>
                    <label for="s-plugin-payrem-sendtest-email-input">
                        Отправить на адрес
                    </label>
                    <input type="email" name="sendtest[email]" id="s-plugin-payrem-sendtest-email-input">
                </div>
                <div>
                    <label for="s-plugin-payrem-sendtest-delay-input">Задержка</label>
                    <span class="hint">Число дней с момента создания выбранного заказа. Одно из значений, указанных в настройках</span>
                    <br>
                    <input type="number" min="1" name="sendtest[delay]" id="s-plugin-payrem-sendtest-delay-input">
                </div>
                <div style="margin-top: 20px">
                    <button type="button" class="green" id="s-plugin-payrem-test-btn">[`Send test message`]</button>
                </div>
            </div>
        </div>
        <div class="clear-both"></div>
    </div>
</div>
<script type="text/javascript">
    $(function () {
        if ($.payrem === undefined) {
            $.payrem = {
                init: function () {
                    $("#s-plugin-payrem-test-btn").unbind('click').click(function () {
                        $.post(
                                "?plugin=payrem&action=testsend",
                                $("input,select", "#s-plugin-payrem-sendtest").serialize(),
                                function (r) {

                                }
                        )
                    })
                }
            }
        }

        $.payrem.init();
    })
</script>
